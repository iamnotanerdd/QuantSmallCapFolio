:root {
    --bg-color: #0f172a;
    --card-bg: #1e293b;
    --text-primary: #f8fafc;
    --text-secondary: #94a3b8;
    --accent: #3b82f6;
    --border: #334155;
    --success: #10b981;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-primary);
    line-height: 1.6;
}

.app-container {
    max-width: 1900px;
    margin: 0 auto;
    padding: 2rem;
}

header {
    margin-bottom: 2rem;
    text-align: center;
}

h1 {
    font-weight: 600;
    font-size: 2.5rem;
    background: linear-gradient(to right, #60a5fa, #a78bfa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.subtitle {
    color: var(--text-secondary);
}

.loading {
    text-align: center;
    padding: 2rem;
    font-size: 1.2rem;
    color: var(--accent);
}

/* Scroll Container */
.table-wrapper {
    overflow: auto;
    /* Enable both X and Y scrolling */
    max-height: 80vh;
    /* Viewport constraint for vertical scroll */
    background: var(--card-bg);
    border-radius: 12px;
    border: 1px solid var(--border);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    position: relative;
}

table {
    width: 100%;
    border-collapse: separate;
    /* Required for sticky borders to sometimes play nice, but collapse is usually ok. separate allows border-spacing 0 */
    border-spacing: 0;
    font-size: 0.9rem;
    white-space: nowrap;
}

th,
td {
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border);
}

th {
    color: var(--text-secondary);
    font-weight: 500;
    position: sticky;
    /* Default sticky for all headers */
    z-index: 10;
}

/* 2-Tier Header styling */
.month-header {
    text-align: center;
    border-right: 1px solid var(--border);
}

.sub-header {
    font-size: 0.8rem;
    color: var(--text-secondary);
}

.d-num {
    text-align: right;
    font-family: 'Roboto Mono', monospace;
}

.d-pct {
    color: var(--success);
}

tr:hover {
    background-color: rgba(59, 130, 246, 0.05);
}

/* Zebra striping - handled carefully with background colors on sticky cells later */
tr:nth-child(even) {
    background-color: rgba(255, 255, 255, 0.02);
}


/* --- Sticky Layout Logic --- */

/* 1. Vertical Sticking (Row 1 & Row 2) */

/* Row 1: Months / Static Headers */
thead tr:nth-child(1) th {
    top: 0;
    z-index: 20;
    background-color: #0f172a;
    height: 50px;
    box-shadow: 0 1px 0 var(--border);
    /* Visual border since border-collapse might be separate */
}

/* Row 2: Sub-headers */
thead tr:nth-child(2) th {
    top: 50px;
    /* Exact height of Row 1 */
    z-index: 20;
    background-color: #1e293b;
    height: 40px;
    box-shadow: 0 1px 0 var(--border);
}

/* 2. Horizontal Sticking (Columns 1, 2, 3) */

/* Set widths */
th:nth-child(1),
td:nth-child(1) {
    width: 320px;
    min-width: 320px;
    left: 0;
}

th:nth-child(2),
td:nth-child(2) {
    width: 140px;
    min-width: 140px;
    left: 320px;
}

th:nth-child(3),
td:nth-child(3) {
    width: 120px;
    min-width: 120px;
    left: 460px;
    border-right: 2px solid var(--accent);
}

/* Apply sticky/bg to Data Rows */
tbody td:nth-child(1),
tbody td:nth-child(2),
tbody td:nth-child(3) {
    position: sticky;
    z-index: 15;
    /* Higher than data (0), lower than headers (20) */
    background-color: var(--card-bg);
}

/* Match Zebra background for sticky data columns */
tbody tr:nth-child(even) td:nth-child(1),
tbody tr:nth-child(even) td:nth-child(2),
tbody tr:nth-child(even) td:nth-child(3) {
    background-color: #1a253a;
    /* Darker stripe color */
}

/* 3. The Intersection (Top-Left) */
/* Row 1, Cells 1-3. They have rowspan=2 so they cover both top rows. */
thead tr:first-child th:nth-child(1),
thead tr:first-child th:nth-child(2),
thead tr:first-child th:nth-child(3) {
    z-index: 30;
    /* Highest: On top of columns and headers */
    top: 0;
    height: 90px;
    /* 50 + 40 */
    background-color: #0f172a;
    box-shadow: 0 1px 0 var(--border);
}

/* --- Mobile Responsiveness --- */
@media (max-width: 768px) {
    .app-container {
        padding: 5px;
        /* Minimal padding */
    }

    h1 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }

    .subtitle {
        font-size: 0.9rem;
    }

    /* Disable sticky columns on mobile */
    th:nth-child(1),
    td:nth-child(1),
    th:nth-child(2),
    td:nth-child(2),
    th:nth-child(3),
    td:nth-child(3) {
        position: static !important;
        width: auto !important;
        min-width: auto !important;
        border-right: none !important;
        background-color: transparent !important;
        left: auto !important;
        box-shadow: none !important;
    }

    /* Reset row background for unsticky columns */
    tbody tr:nth-child(even) td:nth-child(1),
    tbody tr:nth-child(even) td:nth-child(2),
    tbody tr:nth-child(even) td:nth-child(3) {
        background-color: transparent;
        /* Let row color handle it */
    }

    /* Keep Total row sticky at bottom? Yes, but ensure it doesn't break layout */
    .total-row td {
        position: sticky;
        bottom: 0;
        z-index: 25 !important;
        font-size: 0.8rem;
        /* Smaller font for total */
    }

    /* Fix Vertical Header Sticking */
    /* Remove the complex 'corner' intersection logic */
    thead tr:first-child th:nth-child(1),
    thead tr:first-child th:nth-child(2),
    thead tr:first-child th:nth-child(3) {
        z-index: 20;
        height: auto;
        position: sticky;
        /* Keep top sticky */
        top: 0;
    }

    /* Reduce font sizes/padding for mobile */
    th,
    td {
        padding: 8px 6px;
        font-size: 0.8rem;
    }

    /* Allow full horizontal scroll */
    .table-wrapper {
        max-width: 100%;
        max-height: 75vh;
        border-radius: 8px;
    }
}